26-03-25
возвращаюсь к примерам 
неоходимость оценки производных

---
немножко начну отпускать в свободное плавание. Дальше самостоятельно лабораторные по образцу с выкладками

Уровень изложения разный.
Полезная литра
- "Численные методы для техникума"
- Самарский Гулин "Численные методы" учебник мехмата МГУ
- Копченова Дубинский "Вычислительные методы"

3я лаба ==Оценка априорной погрешности==

---

начнем с точки 
Формула конечных приращений Лагранжа
$$\Delta y^* = f(x) - f(x^*) = \sum_{i=1}^m f'_{x_i}(\overline x)(x_i - x_i^*), \overline x \in [x, x^*]$$
Где 
$$f'_{x_i}(x) = \frac{\partial f(x)}{\partial x_i}$$
$$\Delta y^* \leq \sum_{i=1}^m \max_x |f'_{x_i}(x)|\Delta x_i$$

---
$$\Delta y^* \leq \sum_{j=1}^m \nu_j \Delta x_j$$
Если приращение достаточно малое, то можно заменять $x \leftrightarrow x^*$

---
Умножаем слева и справа:
$$\frac{|f(x)|}{|f(x)|}\Delta y^* \leq \sum_{j=1}^m \nu_{j\Delta} \Delta x_j \frac{|x_j|}{|x_j|}$$
$${|f(x)|}\Delta y^* \leq \sum_{j=1}^m \frac{\max_x|f'_{x_j}(x)|}{|f(x)|}|x_j| \delta x^*_j$$
$$\Delta y^* \leq \sum_{j=1}^m \nu_j \delta x_j^*, \quad \nu_j = \frac{\max_x |f'_{x_j}(x)| |x_j|}{|f(x)|}$$

как будем пользоваться этим? для поиска корней
Мы решали квадратное уравнение  $x^2 + bx + c = 0, b = 1000, c = 1$
$$\sqrt D = \sqrt{b^2 - 4c} \sim 10^3$$
$$x_1 = -10^3, \quad x_2 = -10^{-3}$$
Дальше то, чего не было.
$$x_{1,2} = \frac{-b \pm \sqrt D}{2} = \frac{-b \pm \sqrt{b^2 - 4c}}2$$
Рассмотрим корни как функции от коэффициентов
$$x_1 \rightarrow y_1(b,c), x_2 \rightarrow y_2(b,c)$$
Первая функция
$$\begin{aligned}
&\frac{\partial y_1(b,c)}{\partial b} = \frac 12\left(-1 + \frac{0.5}{\sqrt{D}} 2b \right) = \frac 12 \left(-1 + \frac{b}{\sqrt D}\right) = \\
&= \frac{b - \sqrt D}{ 2\sqrt D}
\end{aligned}$$
$$\frac{\partial y_1(b,c)}{\partial c} = \frac 12 \left(\frac{0.5}{\sqrt D}(-4)  \right) = - \frac 1 {\sqrt{D}}$$
Вторая функция
$$\begin{aligned}
&\frac{\partial y_2(b,c)}{\partial b} = \frac 12\left(-1 - \frac{0.5}{\sqrt{D}} 2b \right) = \frac 12 \left(-1 - \frac{b}{\sqrt D}\right) = \\
&= \frac{-b - \sqrt D}{ 2\sqrt D}
\end{aligned}$$
$$\frac{\partial y_2(b,c)}{\partial c} = -\frac 12 \left(\frac{0.5}{\sqrt D}(-4)  \right) =  \frac 1 {\sqrt{D}}$$
Подставим все оценки производных для оценки погрешности с помощью формул, которые вывели ранее. У нас 2 функции. Будут в 3х случаях 1, а в одном $10^{-6}$.
$$\nu_{1,c} 
= \frac{|c|^* \max_x |\frac{\partial y_1}{\partial c}|}{\underbrace{|y_1(b,c)|}_{=|x_1|}}
= \frac{-1 * 10^{-3}}{-10^3} = 10^{-6}$$
Если бы было везде один, то значит погрешность входных данных, не меняет погрешность выходных. В нашем случае, погрешность c слабо влияет на результат. **И это хорошо.**
Получается, что коэффициент c можем представить сколь угодно грубо, притом, что коэффициент b требует соответствия в заданной точности представления.
Иногда маленький рост погрешности может позволить отбросить некоторые параметры. Но иногда при большом росте погрешности может сильно усложнить решение.

В данном случае, не происходит роста погрешности(даже наоборот можно представить один из коэффициентов очень грубо). При этом возможна ситуация плохой обусловленности системы за счет одного из коэффициентов. В силу чего, при реализации численного алгоритма, его начинают с **предмашинного** анализа задачи и вычислительного алгоритма
Мы должны отличать предмашинный анализ(вычислительной устойчивости), и анализ алгоритма.

---
Рассмотрим пример, где неустойчивость приводит к катастрофе. Пример бутафорский, чтоб мы поняли суть проблемы. 
**ПРИМЕР 2:==Численное интегрирование.==**
О чем идет речь?
Нам нужно найти интеграл
$$I_n = \int_0^1 x^n e^{1-x}dx$$
Начинаем аналитически решить эту задачу. Будет сложно, но можно получить реккурентную формулу. Но она нам не помогает.
Решение есть, но мы не можем его получить, так как алгоритм высилительно не устойчивый.
$$\begin{aligned}
& \int_0^1 x^n e^{1-x}dx = \int_0^1x^n d(-e^{1-x}) = \\
&= -x^ne^{1-x} |_0^1 + \int_0^1 e^{1-x}d(x^n) = \\
&= -1 + \int_0^1 x^{n-1}e^{1-x}dx \Rightarrow \\
\\
&I_n = n I_{n-1}-1, n\geq 1, \\
&I_0 = \int_0^1dx = e-1 \sim 1,71828
\end{aligned}$$

Начинаем подставлять, с предположением, что есть ограничение разрядной сетки. Будем подставлять с учетом, что есть всего 6 цифр после запятой в разрядной сетке.
$$\begin{aligned}
I_1 = 1 * 1,71828 -1 = 0,718280 \\
I_2 = 2* 0,718280 -1 = 0,436560 \\
I_3 = 3* 0,436560 -1 = 0,309680 \\
I_4 = 4* 0,309680 -1 = 0,238720 \\
I_5 = 5* 0,238720 -1 = 0,193600 \\
I_6 = 6 * 0,193600 -1 = 0,161600 \\
I_7 = 7* 0,161600 -1 = 0,131200 \\
I_8 = 8*0,131200 - 1 = 0,049600\\
I_9 = 9*0,049600 -1 = -0,5536 \\
...
\end{aligned}$$
Произошла катастрофическая потеря точности, далее значения будут уходить в бесконечность. Что делать в этой ситуации? 
Пойти с другой стороны! 
Что мы делаем на каждом шаге? Умножаем на n. Значит можно вывести общую формулу через сумму и разность факториалов. 

Как формировалась погрешность?
$$I = I^* + \Delta I^*$$
$$I^* = I - \Delta I^*$$
$$nI^* = nI - n\Delta I^*$$
Получаем в результате ФАКТОРИАЛЬНАЯ ПОГРЕШНОСТЬ ОУЖАС!!!
$$n! I^* = n!I - n! \Delta I^*$$
Поэтому можем пойти от обратного и выражать формулы в обратном порядке
$$I_{n-1} = \frac{1 + I_n}{n}$$
Так погрешность постепенно уменьшается. Но мы пока не можем получать произвольную $I_n$

Пользуются очень грубым приближением.
$$I_n = \int_0^1 x^n e^{1-x}dx \leq e \int_0^1 x^{55}dx =\frac e{56}$$
Первое значение можно задать очень очень очень приближенно, так как погрешность будет уменьшаться. 

Сделаем вывод
Таким образом, достаточно грубо оценив стартовое значние $I_{55}$ можно получить все значения с $n = 1 ... 54$.

Последний пример в оставшиеся 10 минут.
Упражнения с двойной точностью. Нужно найти $e^{-8.1}$
$$e^{x} = \sum_{i=0}^n \frac{x^i}{i!} = 1 + x + \frac{x^2}{2} + \frac{x^3}{3!} + ... + \frac{x^n}{n!} + o(x^n)$$
Посчитаем с помощью формулы при n = 36
$$e^{-8.1} \sim 1 - 8.1 + 32.8050 - 88.5737 + 179.362 -290.566 ... = 0.000649915$$
Но точное значение $e^{-8.1} = 0.000303539$

Нам нужно хотя бы первую цифру получить. Как? С помощью упражнений двойной точности.
$$e^{-8.1} = \frac{1}{e^{8.1}}$$
Если мы избавляемся от операции вычитания, то мы очень сильно повышаем точность вычислений.
Таким образом требуется избавиться от операции вычитания, которая в ряде случаев приводит к необоснованному накоплению погрешности, особенно когда операций много, и еще более особенно когда считаем промежуточные значния.
Рекомендуется вычислять функцию от положительного аргумента и после вычислять значение для отрицательного аргумента.